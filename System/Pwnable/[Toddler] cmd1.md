![](Attachments/{074744E8-64C9-4D11-B992-2CA155836C63}.png)

![](Attachments/{56E728FD-200C-495D-B3E5-A98FCC707139}.png)

cmd1.cë¶€í„° ì½ì–´ë³´ì.

```c
#include <stdio.h>
#include <string.h>

int filter(char* cmd){
        int r=0;
        r += strstr(cmd, "flag")!=0;
        r += strstr(cmd, "sh")!=0;
        r += strstr(cmd, "tmp")!=0;
        return r;
}
int main(int argc, char* argv[], char** envp){
        putenv("PATH=/thankyouverymuch");
        if(filter(argv[1])) return 0;
        system( argv[1] );
        return 0;
}
```

PATH í™˜ê²½ë³€ìˆ˜ë¥¼ `/thankyouverymuch`ë¡œ ì„¤ì •í•´ì„œ ì´ˆê¸°í™”í•œë‹¤.
ì´í›„ `system( argv[1] )` í˜¸ì¶œ ì‹œ, ì»¤ë§¨ë“œë¥¼ `/thankyouverymuch`ì—ì„œ ì°¾ê²Œ ëœë‹¤.

ì¸ìê°’ì—ì„œ flag, sh, tmpë¥¼ í•„í„°ë§í•˜ê³ , í•˜ë‚˜ë¼ë„ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ ì¢…ë£Œëœë‹¤.


### í•´ê²°

Linuxì—ì„œ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´ëŠ” ëª¨ë‘ `bin` ë””ë ‰í† ë¦¬ì— ì¡´ì¬í•œë‹¤.
í•˜ì§€ë§Œ `/bin/cat`, `/bin/ls`ë¥¼ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹  `cat`, `ls`ë§Œ ì…ë ¥í•´ë„ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë°, ì´ëŠ” PATHì— ë¯¸ë¦¬ `/bin`ì´ë¼ê³  ëª…ì‹œë˜ì–´ ìˆê³  í™˜ê²½ë³€ìˆ˜ PATHë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

ì´ë•Œ `cmd1.c`ì—ì„œ `putenv`ë¡œ í™˜ê²½ë³€ìˆ˜ë¥¼ ì´ˆê¸°í™”í•˜ë¯€ë¡œ ëª…ë ¹ì–´ì˜ ì ˆëŒ€ê²½ë¡œë¥¼ ì ì–´ì¤„ ìˆ˜ ìˆë‹¤.

ë˜, í•„í„°ë§ì„ í•˜ê¸° ë•Œë¬¸ì— \* ì™€ì¼ë“œì¹´ë“œë¥¼ ì‚¬ìš©í•´ flagì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.

![](Attachments/{76DC905B-A567-4BAE-ACC8-DC1DEDEB003C}.png)

ì•„ë‹ˆë©´ `export` ì»¤ë§¨ë“œë¡œ ì¼ì‹œì ìœ¼ë¡œ í˜„ì¬ ì„¸ì…˜ì—ì„œë§Œ ìœ íš¨í•œ í™˜ê²½ë³€ìˆ˜ë¥¼ ì„¤ì •í•˜ëŠ” ë°©ë²•ë„ ìˆë‹¤.

ğŸš©